<h2>投稿詳細</h2>

<div>
    <h2>
      <%= attachment_image_tag @post.user, :profile_image, :fill, 80, 80, fallback: "no_image.jpg", class:'rounded-circle' %>
      投稿者:<%= @post.user.name %>
    </h2>
    <h2>
      <!--postモデルに定義したfavorite_by?メソッドを使用-->
      <% if @post.favorited_by?(current_user) %> 
        <%= link_to post_favorites_path(@post.id), method: :delete do %>
          ♥<%= @post.favorites.count %> いいね
        <% end %>
      <% else %>
        <%= link_to post_favorites_path(@post.id), method: :post do %>
          ♡<%= @post.favorites.count %> いいね
        <% end %>
      <% end %>
    </h2>
    <!--閲覧者が投稿者なら削除ボタンを表示-->
    <% if @post.user.id == current_user.id %>
      <%= link_to "投稿を削除", post_path(@post.id), method: :delete %>
    <% end %>
    <!-- -->
      <p><%= attachment_image_tag @post, :image, :fill, 500, 500, format: 'jpeg' %></p>
      <h3>投稿内容</h3>
      <h4><%= @post.sentence %></4>
    <h2>コメントする</h2>
      <%= form_with model:[@post,@post_comment], url: post_post_comments_path(@post.id), local: true do |f| %>
        <%= f.text_area :comment,class:'form-control' %>
        <%= f.submit "コメントする",class:'form-control, btn-primary' %>
      <% end %>
    <div>
      <% @post.post_comments.each do |comment| %>
        <%= attachment_image_tag comment.user, :profile_image, :fill, 100, 100, fallback: "no_image.jpg"%>
        <%= comment.user.name %>
        <%= comment.comment %>
        <!--ログイン中ユーザーのidとのコメントのユーザーのidが一致した場合、削除ボタン出現-->
        <% if current_user.id == comment.user.id %>
          <%= link_to 'コメント削除', post_post_comment_path(comment.id), method: :delete %>
        <% end %>
        <!-- -->
      <% end %>
    </div>
</div>

